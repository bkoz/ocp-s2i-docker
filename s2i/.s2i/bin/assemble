#!/usr/bin/env bash

/usr/local/s2i/assemble

context=ROOT.xml
conf=${JWS_HOME}/conf/Catalina/localhost

echo "****** Adding reloadable option for ROOT context ******"
mkdir -vp ${conf}
echo "<Context docBase=\"ROOT\" path=\"\" reloadable=\"true\"></Context>" | tee ${conf}/ROOT.xml

search="catalina.sh run"
replace="catalina.sh jpda run"
run=${JWS_HOME}/bin/launch.sh

echo "****** Changing \"${search}\" to \"${replace}\" in ${run} ******"
sed -i "s/${search}/${replace}/g" ${run}